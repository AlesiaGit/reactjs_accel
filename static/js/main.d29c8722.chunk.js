(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){e.exports=a(182)},119:function(e,t,a){},120:function(e,t,a){},121:function(e,t,a){},181:function(e,t,a){},182:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(33),i=a.n(o),c=a(26),s=a(9),p=a(39),l="bumpyroads/selectedTrip/TRIP_SELECTED",u="bumpyroads/selectedTrip/NO_TRIPS_SELECTED",d=null;function m(e){return{type:l,data:e}}var h=a(10),f="bumpyroads/bumpTrip/ADD_BUMPS",v="bumpyroads/bumpTrip/UPDATE_LOCATION",g="bumpyroads/bumpTrip/UPDATE_ACCELERATION",b="bumpyroads/bumpTrip/RESET_TRIP",w="bumpyroads/bumpTrip/RESET_MOVE",E={path:[],currentLocation:{lat:0,lng:0,timestamp:0,speed:0},previousLocation:{},previousAcceleration:{x:0,y:0,z:0},zoom:16,angle:0,move:0,distance:0,bumps:[]};function O(e){return{type:v,data:e}}function y(){return{type:b}}var C=a(11),T="bumpyroads/menu/FAVORITIES_LIST_VIEW",j="bumpyroads/menu/SELECTED_TRIP_VIEW",M="bumpyroads/menu/DRAWER_VIEW",L="bumpyroads/menu/CLOSE_DRAWER_VIEW",S="bumpyroads/menu/BUMPS_MAP_VIEW",D="bumpyroads/menu/SHARE_VIEW",N="bumpyroads/menu/CLOSE_SHARE_VIEW",B="bumpyroads/menu/CHECK_TRIP_VIEW",k={isFavoritiesListView:!1,isSelectedTripView:!1,isDrawerView:!1,isBumpsMapView:!1,isShareView:!1,isCheckTripView:!1,title:"",iconleft:"",iconright:""},R=function(e,t){var a;return Object(h.a)({},k,(a={},Object(C.a)(a,t.menuitem,!0),Object(C.a)(a,"title",t.title),Object(C.a)(a,"iconleft",t.iconleft),Object(C.a)(a,"iconright",t.iconright),a))};function V(){return{type:j,menuitem:"isSelectedTripView",title:"Back to list",iconleft:"back-arrow",iconright:"share-icon"}}function A(){return{type:M,status:!0}}function z(){return{type:L,status:!1}}function x(){return{type:S,menuitem:"isBumpsMapView",title:"Report a bump",iconleft:"burger-icon",iconright:""}}function I(){return{type:B,menuitem:"isCheckTripView",title:"Check your trip",iconleft:"burger-icon",iconright:""}}var _="bumpyroads/mode/RECORDING",F="bumpyroads/mode/STOP_RECORDING",P="bumpyroads/mode/BUILDING_ROUTE",G="bumpyroads/mode/GUIDANCE",W="bumpyroads/mode/STOP_GUIDANCE",U={isRecording:!1,isBuildingRoute:!1,isGuidance:!1,color:"#757d75",text:"Start Recording"};var H=a(23),Q="bumpyroads/favorities/ADD_TO_FAVORITIES",q="bumpyroads/favorities/DELETED_FROM_FAVORITIES",K=JSON.parse(localStorage.getItem("favorities"))||[];var J="bumpyroads/dom/SET_DIMENTIONS",Z="bumpyroads/dom/SET_RATIO",X="bumpyroads/dom/CHANGE_BARCOLOR",$={width:0,height:0,ratio:1,color:"#fbad19"};function Y(e){return{type:J,dimentions:e}}function ee(e){return{type:Z,ratio:e}}function te(e){return{type:X,color:e}}var ae="bumpyroads/dom/ADD_BUMPS",ne=[];function re(e){return{type:ae,bumps:e}}var oe=a(22),ie=a.n(oe),ce=ie.a.initializeApp({apiKey:"AIzaSyBexhCuV6JNCsyakFOeBK7NmFb_oM_pgxo",authDomain:"bumpyroadsinformer.firebaseapp.com",databaseURL:"https://bumpyroadsinformer.firebaseio.com",projectId:"bumpyroadsinformer",storageBucket:"",messagingSenderId:"854546127925",appId:"1:854546127925:web:d3c2a81c7c4e9ba6"}).firestore(),se="bumpyroads/stats/GET_STATS",pe="bumpyroads/stats/ADD_TO_STATS",le={bumpsCount:0,distanceTotal:0,tripsCount:0},ue=ce.collection("stats").doc("totals"),de=ce.collection("bumpsmap").doc("bumps");function me(e){ue.get().then(function(t){t.exists&&(console.log(e,t.data()),function(e,t){var a=t.bumpsCount,n=t.distanceTotal,r=t.tripsCount;console.log(Object(h.a)({},e,{bumpsCount:a,distanceTotal:n,tripsCount:r})),Object(h.a)({},e,{bumpsCount:a,distanceTotal:n,tripsCount:r})}(e,t.data()))})}function he(e,t){var a;(a=t.tripdata,new Promise(function(e,t){var n=0;a.bumps.forEach(function(e){return de.update({bumps:ie.a.firestore.FieldValue.arrayUnion(e)}).then(function(){return n++}).catch(function(e){return t(new Error("Bumps are not updated in database"))})}),n===a.bumps.length&&e("success")})).then(function(){return new Promise(function(e,t){de.get().then(function(t){t.exists&&e(t.data().bumps)}).catch(function(e){return t(new Error("Bumps are not updated in database"))})})}).then(function(e){return a=e.length,n=t.tripdata.distance,new Promise(function(e,t){ue.update({bumpsCount:a,distanceTotal:ie.a.firestore.FieldValue.increment(Math.round(n)),tripsCount:ie.a.firestore.FieldValue.increment(1)}).then(function(){return e("success")}).catch(function(e){return t(new Error("Statistics is not updated in db"))})});var a,n}).then(function(){return test=me(e)})}var fe={selectedTrip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:case u:return t.data;default:return e}},trip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(h.a)({},e,{bumps:e.bumps.concat(t.data)});case g:return Object(h.a)({},e,{previousAcceleration:t.data.previousAcceleration});case v:return Object(h.a)({},e,{previousLocation:e.currentLocation,currentLocation:t.data.currentLocation,path:t.data.path,angle:t.data.angle,move:t.data.move,distance:t.data.distance});case w:return Object(h.a)({},e,{move:0});case b:return Object(h.a)({},E);default:return e}},menu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:case j:case S:case B:return R(e,t);case M:case L:return Object(h.a)({},e,{isDrawerView:t.status});case D:case N:return Object(h.a)({},e,{isShareView:t.status});default:return e}},mode:function(){var e,t,a,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case _:return Object(h.a)({},U,(e={},Object(C.a)(e,o.mode,o.on),Object(C.a)(e,"color",o.color),Object(C.a)(e,"text",o.text),e));case F:return Object(h.a)({},U);case P:return Object(h.a)({},U,(t={},Object(C.a)(t,o.mode,o.on),Object(C.a)(t,"text",o.text),t));case G:return Object(h.a)({},U,(a={},Object(C.a)(a,o.mode,o.on),Object(C.a)(a,"color",o.color),Object(C.a)(a,"text",o.text),a));case W:return Object(h.a)({},U,(n={},Object(C.a)(n,o.mode,o.on),Object(C.a)(n,"color",o.color),Object(C.a)(n,"text",o.text),n));default:return r}},favorities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return[].concat(Object(H.a)(e.slice(-4)),[t.data]);case q:return e.filter(function(e){return e.id!==t.id});default:return e}},dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return Object(h.a)({},e,{width:t.dimentions.width,height:t.dimentions.height});case Z:return Object(h.a)({},e,{ratio:t.ratio});case X:return Object(h.a)({},e,{color:t.color});default:return e}},bumps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return[].concat(Object(H.a)(e),Object(H.a)(t.bumps));default:return e}},stats:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case se:return me(e);case pe:return he(e,t);default:return e}}},ve=Object(p.b)(fe),ge=Object(p.c)(ve),be=(a(119),a(4)),we=a(5),Ee=a(7),Oe=a(6),ye=a(8),Ce=(a(120),a(28)),Te=a(13),je=(a(57),a(58),function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this,t=this.props.menu,a=t.isFavoritiesListView,n=t.isSelectedTripView;return a||n?null:r.a.createElement("div",{className:"bottom-ruler-btn",style:{backgroundColor:this.props.color},onClick:function(){return e.props.toggleButton()}},this.props.text)}}]),t}(n.Component)),Me=Object(s.b)(function(e){return{menu:e.menu}})(je),Le=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"header-menu"},r.a.createElement("div",{className:"header-left-menu"},r.a.createElement("div",{className:"header-menu-icon ".concat(this.props.menu.iconleft),onClick:function(){return e.props.onLeftMenuToggle()}}),r.a.createElement("div",{className:"page-title"},this.props.menu.title)),r.a.createElement("div",{className:"header-right-menu"},r.a.createElement("div",{className:"header-menu-icon ".concat(this.props.menu.iconright),onClick:function(){return e.props.onRightMenuToggle()}})))}}]),t}(n.Component),Se=Object(s.b)(function(e){return{menu:e.menu}})(Le),De=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this,t=this.props.menu,a=t.isFavoritiesListView,n=t.isBumpsMapView,o=a||n?"flex":"none";return r.a.createElement("div",{className:"header-submenu",style:{display:o}},["Favorities List","Bumps Map"].map(function(t,a){return r.a.createElement("div",{className:"header-submenu-tab ".concat(e.props.markActiveTab(t)?"tab-active":""),onClick:function(){return e.props.onSubmenuTabSelect(t)},key:a},t)}))}}]),t}(n.Component),Ne=Object(s.b)(function(e){return{menu:e.menu}})(De),Be=(a(121),a(77),a(72)),ke={selectTrip:m,selectTripView:V},Re=function(e){function t(){var e,a;Object(be.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(Ee.a)(this,(e=Object(Oe.a)(t)).call.apply(e,[this].concat(r)))).setTripQuality=function(e){var t=["#e34929","#fbad19","#4c88b7"];return e.bumps.length>12?t[0]:e.bumps.length<8?t[2]:t[1]},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this,t=this.props.favorities;return t.length?r.a.createElement("div",{className:"fav-list"},t.map(function(t,a){return r.a.createElement("div",{className:"fav-item",style:{borderColor:e.setTripQuality(t)},onClick:function(){e.props.selectTrip(t),e.props.selectTripView()},key:a},r.a.createElement("div",{className:"fav-route"},"From: ",t.start),r.a.createElement("div",{className:"fav-route"},"To: ",t.end),r.a.createElement("div",{className:"fav-bumps-count"},t.bumps.length," bumps per ",t.distance?t.distance.toFixed(1):0," km"))})):null}}]),t}(n.Component),Ve=Object(s.b)(function(e){return{favorities:e.favorities,stats:e.stats}},ke)(Re),Ae=6371e3;function ze(e){return[" ","_"].forEach(function(t){e=e.split(t).map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join("")}),e}function xe(e,t){for(var a in e)if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1;return!0}function Ie(e){return e*Math.PI/180}function _e(e,t,a,n){var r=Ie(a-e),o=Ie(n-t),i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(Ie(e))*Math.cos(Ie(a))*Math.sin(o/2)*Math.sin(o/2);return 2*Ae*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))}function Fe(e,t){var a=[];return e.forEach(function(n,r){if(r<e.length-1){var o,i,c=_e(n.lat,n.lng,e[r+1].lat,e[r+1].lng);t.forEach(function(t){o=_e(n.lat,n.lng,t.lat,t.lng),i=_e(e[r+1].lat,e[r+1].lng,t.lat,t.lng),o+i<c+10&&a.push({lat:t.lat,lng:t.lng})})}}),a}function Pe(e,t,a){var n=t,r=_e(e.lat,e.lng,t.lat,t.lng);return a.forEach(function(t){console.log(e);var a=_e(e.lat,e.lng,t.lat,t.lng);n=a<r?t:n,r=a<r?a:r}),n}var Ge,We={selectTrip:m,addToFavorities:function(e){return{type:Q,data:Object(h.a)({},e,{id:"f".concat((~~(1e8*Math.random())).toString(16))})}},selectTripView:V,addTripBumps:function(e){return{type:f,data:e}},updateLocation:O,updateAcceleration:function(e){return{type:g,data:e}},resetTrip:y,resetMove:function(){return{type:w}},setDimentions:Y,setRatio:ee,addBumps:re,addToStats:function(e){return{type:pe,tripdata:e}}},Ue={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},He=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){window.addEventListener("resize",a.updateWindowDimensions)},a.componentDidUpdate=function(e,t){e.mode.isRecording!==a.props.mode.isRecording&&(!0===a.props.mode.isRecording?a.startRecording():a.stopRecording()),e.mode.isGuidance!==a.props.mode.isGuidance&&(!0===a.props.mode.isGuidance?a.startGuidance():a.stopGuidance()),e.menu.isShareView!==a.props.menu.isShareView&&!0===a.props.menu.isShareView&&a.saveSharedTripToDatabase(),e.menu.isBumpsMapView!==a.props.menu.isBumpsMapView&&!1===a.props.menu.isBumpsMapView&&a.props.resetTrip(),e.favorities!==a.props.favorities&&localStorage.setItem("favorities",JSON.stringify(a.props.favorities))},a.componentWillUnmount=function(){window.removeEventListener("resize",a.updateWindowDimensions)},a.updateWindowDimensions=function(){a.props.setDimentions({width:window.innerWidth,height:window.innerHeight}),a.props.setRatio({ratio:window.innerWidth/window.innerHeight})},a.startRecording=function(){return a.props.resetTrip(),navigator&&navigator.geolocation?(Ge=navigator.geolocation.watchPosition(a.updateLocationData,a.err,Ue),window.DeviceMotionEvent?void window.addEventListener("devicemotion",a.updateAccelerationData):new Error("Accelerator error")):new Error("Navigator error")},a.stopRecording=function(){navigator.geolocation.clearWatch(Ge),window.removeEventListener("devicemotion",a.updateAccelerationData),a.updateFavoritiesData()},a.startGuidance=function(){if(a.props.resetTrip(),!navigator||!navigator.geolocation)return new Error("Navigator error");Ge=navigator.geolocation.watchPosition(a.updateLocationData,a.err,Ue)},a.stopGuidance=function(){navigator.geolocation.clearWatch(Ge),window.removeEventListener("devicemotion",a.updateAccelerationData)},a.err=function(){console.log("error")},a.updateArrayIfPositionChanged=function(e,t){return 0!==e.length&&xe(e[e.length-1],t)?e:[].concat(Object(H.a)(e),[t])},a.updateAccelerationData=function(e){var t=e.acceleration,n=t.x,r=t.y,o=t.z;a.props.updateInterval(e.interval,e.acceleration.x);var i=a.props.trip,c=i.previousAcceleration,s=i.bumps,p=a.props.trip.currentLocation,l=p.lat,u=p.lng;p.timestamp;if(null!==n&&null!==r&&null!==o){var d=n-c.x,m=r-c.y,h=o-c.z;Math.pow(d*d+m*m+h*h,1/3)>2.829226039&&(0!==s.length&&xe(s[s.length-1],{lat:l,lng:u})||a.props.addTripBumps({lat:l,lng:u}),a.props.updateAcceleration({previousAcceleration:{x:n,y:r,z:o}}))}},a.updateSpeedValue=function(e){var t=a.props.trip.currentLocation,n=e.coords.latitude,r=e.coords.longitude,o=e.timestamp,i=a.props.trip.path.length?_e(t.lat,t.lng,n,r):0,c=Math.abs(t.timestamp-o)/1e3;return!i/c?0:i/c*3600/1e3},a.updateAngleValue=function(e){var t=a.props.trip.currentLocation,n=e.coords.latitude,r=e.coords.longitude,o=function(e,t,a,n){var r=n-t,o=Math.sin(r)*Math.cos(a),i=Math.cos(e)*Math.sin(a)-Math.sin(e)*Math.cos(a)*Math.cos(r),c=Math.atan2(o,i);return c=360-(c=(360+(c*=180/Math.PI))%360)}(t.lat,t.lng,n,r);return Math.abs(o-a.props.trip.angle)>22?o:a.props.trip.angle},a.updateLocationData=function(e){var t=a.props.trip.currentLocation,n=a.props.trip,r=n.move,o=n.path,i=n.distance,c=e.coords.latitude,s=e.coords.longitude,p=e.timestamp,l=o.length?_e(t.lat,t.lng,c,s):0;r>5&&a.props.resetMove(),a.props.updateLocation({currentLocation:{lat:c,lng:s,speed:a.updateSpeedValue(e),timestamp:p},path:a.updateArrayIfPositionChanged(o,{lat:c,lng:s}),angle:a.updateAngleValue(e),move:r+l,distance:i+l/1e3})},a.convertToReadableAddress=function(e){return new Promise(function(t,n){for(var r=a.props.google.maps,o=[],i=new r.Geocoder,c=0;c<e.length;c++)i.geocode({location:e[c]},function(a,r){"OK"!==r&&n(new Error("Geocoder failed due to: "+r)),a[0]||n(new Error("No results")),o.push(a[0].formatted_address),e.length===o.length&&t({start:o[0],end:o[1]})})})},a.updateFavoritiesData=function(){var e=a.props.trip,t=e.bumps,n=e.path,r=e.distance;if(n.length){var o=function(e){var t=e.ne,a=e.sw;return{lat:a.lat+(t.lat-a.lat)/2,lng:a.lng+(t.lng-a.lng)/2}}(function(e){var t,a,n,r;return e.forEach(function(e){t=t>e.lat?t:e.lat,a=a<e.lat?a:e.lat,n=n>e.lng?n:e.lng,r=r<e.lng?r:e.lng}),{ne:{lat:t,lng:n},sw:{lat:a,lng:r}}}(n)),i=function(e){return Math.round(14-Math.log(e/2e3)/Math.LN2)}(1e3*r),c=[n[0],n[n.length-1]];a.convertToReadableAddress(c).then(function(e){var c=e.start,s=e.end;a.props.addToFavorities({start:c,end:s,path:n,zoom:i,center:o,bumps:t,distance:r})})}},a.onZoomChanged=function(e,t,a){},a.saveSharedTripToDatabase=function(){ce.collection("shared").doc(a.props.selectedTrip.id).set({tripdata:a.props.selectedTrip}).catch(function(e){return console.log(e)})},a.saveBumpsToDatabase=function(){var e=ce.collection("bumpsmap").doc("bumps"),t=a.props.trip.bumps.filter(function(e){return!a.props.bumps.find(function(t){var a=t.lat;return e.lat===a})&&!a.props.bumps.find(function(t){var a=t.lng;return e.lng===a})});e.get().then(function(a){a.exists&&e.set({bumps:[].concat(Object(H.a)(a.data().bumps),Object(H.a)(t))})})},a.getDatabaseBumpsCount=function(){return ce.collection("bumpsmap").doc("bumps").get().then(function(e){if(e.exists)return e.data().bumps.length})},a.updateStatsInDatabase=function(e){ce.collection("stats").doc("totals").update({bumpsCount:e,distanceTotal:ie.a.firestore.FieldValue.increment(Math.round(a.props.trip.distance)),tripsCount:ie.a.firestore.FieldValue.increment(1)})},a.state={cover:!1,isFetching:!1},a.mymap=r.a.createRef(),a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this.props,t=e.google,a=e.start,n=e.end,o=this.props.menu,i=o.isFavoritiesListView,c=o.isSelectedTripView,s=o.isCheckTripView;return i?r.a.createElement(Ve,null):c?r.a.createElement(nt,{google:t}):s?r.a.createElement("div",{className:"map"},r.a.createElement(Ze,{centerAroundCurrentLocation:!0,google:t,updateLocationData:this.updateLocationData,reportBumpAhead:this.props.reportBumpAhead,start:a,end:n},r.a.createElement(Ye,null))):r.a.createElement("div",{className:"map"},r.a.createElement(Ze,{centerAroundCurrentLocation:!0,google:t,updateLocationData:this.updateLocationData},r.a.createElement(Ye,null),r.a.createElement(Be.Polyline,{path:this.props.trip.path,strokeColor:"#4D8FAC",strokeOpacity:.8,strokeWeight:4})))}}]),t}(n.Component),Qe=Object(Be.GoogleApiWrapper)({apiKey:"AIzaSyBE7mLpixeaO78BgnobMQ_yawg5ZBCX8f0"})(He),qe=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,menu:e.menu,mode:e.mode,favorities:e.favorities,trip:e.trip,bumps:e.bumps}},We)(Qe),Ke={updateLocation:O,resetTrip:y},Je=function(e){function t(e){var a;Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){a.props.centerAroundCurrentLocation&&navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords;a.setState({currentLocation:{lat:t.latitude,lng:t.longitude},isCurrentPositionReceived:!0},function(){return a.props.updateLocationData(e)})}),a.loadMap()},a.reportBumpAhead=function(){var e=a.props.trip.currentLocation,t=e.lat,n=e.lng,r=a.state,o=r.bumpAhead,i=r.routeBumps;console.log(o),a.setState({bumpAhead:Pe({lat:t,lng:n},o,i),distanceToBump:null===o?3:_e(t,n,o.lat,o.lng)},function(){a.state.distanceToBump<3?a.props.reportBumpAhead(!0):a.props.reportBumpAhead(!1)})},a.buildRoute=function(e){var t=a.props.google.maps;a.directionsDisplay.setMap(a.map);var n={origin:e.start,destination:e.end,travelMode:"DRIVING"};a.directionsService.route(n,function(e,n){if("OK"===n){var r=[];t.geometry.encoding.decodePath(e.routes[0].overview_polyline).forEach(function(e){return r.push({lat:e.lat(),lng:e.lng()})}),a.setState({routeBumps:Fe(r,a.props.bumps)},function(){a.databaseBumps=a.setBumpsOnMap(a.state.routeBumps,a.databaseBumps,"#e34929",.8),a.directionsDisplay.setDirections(e),a.setState({bumpAhead:a.state.routeBumps[0]})})}})},a.loadMap=function(){if(a.props.google){var e=a.props.google.maps,t=a.props.zoom,n=a.state.currentLocation,r=n.lat,o=n.lng,i=new e.LatLng(r,o),c=Object.assign({},{center:i,zoom:t,zoomControl:!1,scaleControl:!1,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1});a.map=new e.Map(a.mymap.current,c),a.map&&(a.directionsService=new e.DirectionsService,a.directionsDisplay=new e.DirectionsRenderer);["click","dragend","zoom_changed"].forEach(function(e){return a.map.addListener(e,a.handleEvent(e))}),e.event.trigger(a.map,"ready"),a.map&&!a.props.menu.isCheckTripView&&(a.databaseBumps=a.setBumpsOnMap(a.props.bumps,a.databaseBumps,"#e34929",.8))}},a.recenterMap=function(e){var t=a.map,n=a.props.google.maps;if(t){var r=new n.LatLng(e.lat,e.lng);t.panTo(r)}},a.deleteMarkers=function(e){return e.forEach(function(e){return e.setMap(null)}),[]},a.setBumpsOnMap=function(e,t,n,r){var o=a.props.google.maps,i={path:"M-4,0a4,4 0 1,0 8,0a4,4 0 1,0 -8,0",fillColor:n,strokeColor:n,fillOpacity:1,scale:r,anchor:new o.Point(0,0)};return t=a.deleteMarkers(t),e.forEach(function(e){t.push(new o.Marker({position:{lat:e.lat,lng:e.lng},icon:i,map:a.map}))}),t},a.componentWillUnmount=function(){a.deleteMarkers(a.tripBumps),a.deleteMarkers(a.databaseBumps)},a.renderChildren=function(){var e=a.props.children;if(e)return r.a.Children.map(e,function(e){return r.a.cloneElement(e,{map:a.map,google:a.props.google,mapCenter:a.state.currentLocation,currentLocation:a.props.trip.currentLocation,isCurrentPositionReceived:a.state.isCurrentPositionReceived})})};var n=e.initialCenter,o=n.lat,i=n.lng;return a.state={currentLocation:{lat:o,lng:i},zoom:17,isCurrentPositionReceived:!1,routeBumps:[],bumpAhead:null,distanceToBump:0},a.mymap=r.a.createRef(),a.mymarker=r.a.createRef(),a.tripBumps=[],a.databaseBumps=[],a.directionsBumps=[],a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this;if(e.google!==this.props.google&&this.loadMap(),t.currentLocation!==this.state.currentLocation&&this.recenterMap(this.state.currentLocation),e.trip.currentLocation!==this.props.trip.currentLocation&&this.state.isCurrentPositionReceived&&this.props.mode.isRecording&&(this.recenterMap(this.props.trip.currentLocation),this.setState({currentLocation:this.props.trip.currentLocation})),e.trip.currentLocation!==this.props.trip.currentLocation&&this.state.isCurrentPositionReceived&&this.props.mode.isGuidance&&(this.recenterMap(this.props.trip.currentLocation),this.setState({currentLocation:this.props.trip.currentLocation}),this.reportBumpAhead()),e.trip.bumps!==this.props.trip.bumps&&(this.tripBumps=this.setBumpsOnMap(this.props.trip.bumps,this.tripBumps,"#fbad19",1.2)),e.bumps===this.props.bumps||this.props.menu.isCheckTripView||(this.databaseBumps=this.setBumpsOnMap(this.props.bumps,this.databaseBumps,"#e34929",.8)),e.mode.isBuildingRoute!==this.props.mode.isBuildingRoute&&!0===this.props.mode.isBuildingRoute){var n=this.props,r=n.start,o=n.end,i=n.google;if(""!==r)return this.buildRoute({start:r,end:o});navigator.geolocation.getCurrentPosition(function(e){return a.buildRoute({start:new i.maps.LatLng(e.coords.latitude,e.coords.longitude),end:o})})}}},{key:"handleEvent",value:function(e){var t,a=this,n="on".concat(ze(e));return function(e){t&&(clearTimeout(t),t=null),t=setTimeout(function(){a.props[n]&&a.props[n](a.props,a.map,e)},0)}}},{key:"render",value:function(){var e={width:this.props.dom.width+"px",height:this.props.dom.height+"px",position:"relative"};return r.a.createElement("div",{ref:this.mymap,style:e},"Loading...",this.renderChildren())}}]),t}(n.Component),Ze=Object(s.b)(function(e){return{menu:e.menu,mode:e.mode,trip:e.trip,dom:e.dom,bumps:e.bumps}},Ke)(Je);Je.defaultProps={zoom:16,initialCenter:{lat:53.9124691,lng:27.5122775},centerAroundCurrentLocation:!1};var Xe=[{path:"M69.9,36c0.3-9.3,0.3-9.1,0.3-9.1c0-0.2,0.7-7.9-0.6-15.3c-1.3-7.5-9.7-9.5-9.7-9.5l-0.4,0l-8.9-0.3v0l-8.8,0.3  l-0.4,0c0,0-8.4,2.1-9.7,9.5c-1.3,7.4-0.6,15.1-0.6,15.3c0,0,0-0.3,0.3,9.1c0.4,9.8-0.6,34-0.5,37c0.1,2.9-0.2,9.2,0.4,10.8  c0.6,1.6,2.6,9.6,2.6,9.6s3.2,6.2,16.8,5.3v0c13.5,0.9,16.7-5.3,16.7-5.3s2-8,2.6-9.6c0.6-1.6,0.2-7.9,0.4-10.8  C70.5,70,69.5,45.8,69.9,36L69.9,36z",fill:"#D14C32"},{path:"M61.7,27.5c-3.2-1.6-11.1-1.8-11.1-1.8v0c0,0-8,0.1-11.1,1.8c-3.2,1.6-4.3,2.4-4.1,3.5c0.2,1.1,2.6,12,2.6,12.3  c0,0.3,0.2,0.7,1.5,0.4c1.2-0.4,11.2-0.8,11.2-0.8v0c0,0,10,0.4,11.2,0.8c1.2,0.4,1.5-0.1,1.5-0.4c0-0.3,2.4-11.2,2.6-12.3  C66,29.9,64.9,29.2,61.7,27.5L61.7,27.5z",fill:"#121215"},{path:"M67.4,32.8c0,0,0,12.6,0,16.3c0,3.7,0,8.7-0.3,12.1C66.8,64.7,66.1,80,66.1,80v0.3c0,0-2-5.3-2.4-9.4  c-0.9-4-0.5-14,0-20.1C64,44.8,67,33.9,67.4,32.8z",fill:"#101114"},{path:"M62.4,76.1c-0.2-1.4-0.4-1-0.5-1.1c-0.1-0.1-1.5,0.3-2.1,0.4c-4.6,0.8-9.3,0.6-9.3,0.6v0c0,0-4.7,0.2-9.3-0.6  c-0.6-0.1-2-0.5-2.1-0.4c-0.1,0.1-0.3-0.3-0.5,1.1c-0.2,1.4-1.4,9.9-1.3,10c0.1,0.1,2.9,1.8,7.9,2.6c1.1,0.1,5.3,0.2,5.3,0.2v0  c0,0,4.2-0.2,5.3-0.2c5-0.8,7.8-2.5,7.9-2.6C63.8,86.1,62.7,77.5,62.4,76.1L62.4,76.1z",fill:"#131417"},{path:"M67,36l1.2,0.7V38H67V36z",fill:"#0D0E13"},{path:"M59,2.9c-0.1-0.1-0.2-0.1-0.4-0.2C58.1,2.6,58.3,2.6,59,2.9z",fill:"#C2C6C1"},{path:"M67.7,11.8C66.9,6.6,61,3.7,59,2.9c2,1.4,3.4,9.1,4.5,14c1.1,5.2,1.8,13.5,1.8,13.5s2.4,0.4,3.6,7  C69.7,41.5,68.9,18.8,67.7,11.8L67.7,11.8z",fill:"#D8684A"},{path:"M42.6,2.8c-0.1,0-0.2,0.1-0.4,0.2C42.9,2.7,43.2,2.6,42.6,2.8z",fill:"#C2C6C1"},{path:"M33.5,11.8c-1.2,7-1.9,29.7-1.1,25.5c1.1-6.5,3.6-7,3.6-7s0.6-8.3,1.8-13.5c1.1-4.9,2.5-12.6,4.5-14  C40.3,3.8,34.4,6.6,33.5,11.8z",fill:"#D8684A"},{path:"M63.4,56.8l3.8-2.9v3.4l-3.8,2.4V56.8z M37.7,83.9c-0.2,1.3-0.3,2.2-0.2,2.2c0.1,0.1,2.9,1.8,7.9,2.6  c1.1,0.1,5.3,0.2,5.3,0.2v0c0,0,4.2-0.2,5.3-0.2c5-0.8,7.8-2.5,7.9-2.6c0,0-0.3-2.4-0.6-4.9L37.7,83.9L37.7,83.9z",fill:"#202226"},{path:"M37.3,40.1l24.4-5.8l3.7-1.2c0.2-1.1,0.4-1.9,0.4-2.1c0.2-1.1-0.9-1.9-4.1-3.5c-3.2-1.6-11.1-1.8-11.1-1.8v0  c0,0-8,0.1-11.1,1.8c-3.2,1.6-4.3,2.4-4.1,3.5C35.5,31.7,36.5,36.7,37.3,40.1L37.3,40.1z",fill:"#212428"},{path:"M33.9,32.9c0,0,0,12.6,0,16.3c0,3.7,0,8.7,0.3,12.1c0.3,3.4,0.9,18.7,0.9,18.7v0.3c0,0,2-5.3,2.4-9.4  c0.9-4,0.5-14,0-20.1C37.3,44.8,34.3,33.9,33.9,32.9z",fill:"#101114"},{path:"M69.9,36c0.3-9.3,0.3-9.1,0.3-9.1c0-0.2,0.7-7.9-0.6-15.3c-1.3-7.5-9.7-9.5-9.7-9.5l-0.4,0l-8.9-0.3v0l-8.8,0.3  l-0.4,0c0,0-8.4,2.1-9.7,9.5c-1.3,7.4-0.6,15.1-0.6,15.3c0,0,0-0.3,0.3,9.1c0.4,9.8-0.6,34-0.5,37c0.1,2.9-0.2,9.2,0.4,10.8  c0.6,1.6,2.6,9.6,2.6,9.6s3.2,6.2,16.8,5.3v0c13.5,0.9,16.7-5.3,16.7-5.3s2-8,2.6-9.6c0.6-1.6,0.2-7.9,0.4-10.8  C70.5,70,69.5,45.8,69.9,36L69.9,36z M69.3,83.9c-1.6,9.7-4,11.2-6.7,12.7c-2.7,1.4-11.9,1.6-11.9,1.6v0c-0.9,0-9.3-0.3-11.9-1.6  c-2.7-1.5-5.1-3-6.7-12.7c-1.6-9.7,0.6-13.6,0.4-21.9c-0.3-8.3-0.3-29.6-0.2-32c0.1-2.4-0.6-19.1,1.7-21.5c2.3-2.4,5.6-5.7,7.6-5.8  C42.6,2.7,44,2.6,45,2.6V2.6h5.7v0h5.6v0.1c1.2,0,2.3,0,3.5,0.1c2,0.1,5.3,3.4,7.6,5.8c2.3,2.4,1.6,19.1,1.7,21.5  c0.1,2.4,0.1,23.7-0.2,32C68.6,70.3,70.9,74.2,69.3,83.9L69.3,83.9z",fill:"#9E4A36"},{path:"M34.3,91c0,0,1.5,3.3,4,4.1c2.4,0.9,4.2,1.3,4.2,1.3s-3.1,0-4.8-1C36.1,94.5,34.2,93.1,34.3,91z",fill:"#9E4A36"},{path:"M41.5,2.7c0,0-3.4,1.6-4.4,2.8c-1,1.1-2.5,3-2.6,3.3c0,0.2,0,0.9,0,0.9S40.6,3.1,41.5,2.7z",fill:"#FEFDF8"},{path:"M50.6,1.8L50.6,1.8L50.6,1.8L50.6,1.8z M58.4,3c0-0.3-1.7-0.8-2.2-0.9c-0.4-0.1-5.3-0.2-5.6-0.2l0,0  c-0.3,0-5.2,0.2-5.6,0.3c-0.4,0.1-2.1,0.6-2.2,0.9c0,0.3,0.3,0.5,0.7,0.3s1-0.7,1.4-0.8c0.4-0.1,5.7-0.3,5.7-0.3l0,0  c0.4,0,5.2,0.2,5.6,0.3c0.4,0.1,1,0.6,1.4,0.8C58.1,3.5,58.4,3.3,58.4,3L58.4,3z",fill:"#1D2021"},{path:"M32.8,36.8c0,0-3.4,1.4-3.6,2.7C29,40.8,29,41,29.2,41s3.8-1.9,3.8-1.9v-2.3L32.8,36.8L32.8,36.8z",fill:"#D14C32"},{path:"M29.2,41.3l0-0.3l3.8-1.9v0.3L29.2,41.3z",fill:"#0D0E13"},{path:"M34.3,36.1L33,36.8V38h1.2V36.1z",fill:"#0D0E13"},{path:"M37.9,56.9L34,54v3.4l3.8,2.4V56.9z",fill:"#202226"},{path:"M38.7,76.1c0.2-1.4,0.4-1,0.5-1.1c0.1-0.1,1.5,0.3,2.1,0.4c4.6,0.8,9.3,0.6,9.3,0.6v0c0,0,4.7,0.2,9.3-0.6  c0.6-0.1,2-0.5,2.1-0.4c0.1,0.1,0.3-0.3,0.5,1.1c0.2,1.4,1.4,9.9,1.3,10c-0.1,0.1-2.9,1.8-7.9,2.6c-1.1,0.1-5.3,0.2-5.3,0.2v0  c0,0-4.2-0.2-5.3-0.2c-5-0.8-7.8-2.5-7.9-2.6C37.3,86.1,38.5,77.5,38.7,76.1L38.7,76.1z M39.6,27.5c3.2-1.6,11.1-1.8,11.1-1.8v0  c0,0,8,0.1,11.1,1.8c3.2,1.6,4.3,2.4,4.1,3.5c-0.2,1.1-2.6,12-2.6,12.3c0,0.3-0.2,0.7-1.5,0.4c-1.2-0.4-11.2-0.8-11.2-0.8v0  c0,0-10,0.4-11.2,0.8c-1.2,0.4-1.5-0.1-1.5-0.4c0-0.3-2.4-11.2-2.6-12.3C35.3,29.9,36.4,29.2,39.6,27.5L39.6,27.5z",fill:"#343C3E"},{path:"M38.2,28.3c-2.2,1.2-3,1.9-2.8,2.8c0.2,1.1,2.6,12,2.6,12.3c0,0.3,0.2,0.7,1.5,0.4c0.3-0.1,1-0.2,2-0.2  C39.9,39.9,38.7,31.8,38.2,28.3L38.2,28.3z M63.1,28.2c2.2,1.2,3,1.9,2.8,2.8c-0.2,1.1-2.6,12-2.6,12.3c0,0.3-0.2,0.7-1.5,0.4  c-0.3-0.1-1-0.2-2-0.2C61.4,39.9,62.6,31.8,63.1,28.2L63.1,28.2z",fill:"#2E3436"},{path:"M65.3,29.7c-0.6-0.6-1.8-1.2-3.6-2.2c-3.2-1.6-11.1-1.8-11.1-1.8v0h0v0c-0.6,0-8.1,0.2-11.1,1.8  c-1.8,0.9-2.9,1.6-3.6,2.2l2.8,2.2c0,0,5.7-0.9,11.9-1v0c6.1,0.1,11.8,0.7,11.8,0.7L65.3,29.7L65.3,29.7z",fill:"#202226"},{path:"M59.8,2.7c0,0,3.4,1.6,4.4,2.8c1,1.1,2.5,3,2.6,3.3c0,0.2,0,0.9,0,0.9S60.7,3.1,59.8,2.7z",fill:"#FEFDF8"},{path:"M55.4,3.8H44.8c0,0-2.2,0.6-2.9,8.6c-0.7,8-2,14.1,3,12.7c4.9-1.4,7.6-0.2,9.8-0.3c2.2-0.2,5.6,2.3,4.3-8.6  C57.7,5.2,57.6,4.6,55.4,3.8L55.4,3.8z",fill:"#D8684A"},{path:"M44.5,24.3l1.8-18.1l-1.3,6.4L44.5,24.3z M56.8,24.2L55,6.2l1.3,6.4L56.8,24.2z M66.9,90.9c0,0-1.5,3.3-4,4.1  c-2.4,0.9-4.2,1.3-4.2,1.3s3.1,0,4.8-1C65.2,94.5,67,93,66.9,90.9L66.9,90.9z",fill:"#9E4A36"},{path:"M39.2,75c-0.1,0.1-0.3-0.3-0.5,1.1s-1.4,9.9-1.3,10c0,0,0.7,0.5,2,1L41,75.4C40.3,75.2,39.2,74.9,39.2,75  L39.2,75z M62.4,76.2c-0.2-1.4-0.4-1-0.5-1.1c0-0.1-1.1,0.2-1.8,0.3l1.6,11.8c1.2-0.5,1.9-0.9,2-1C63.8,86.1,62.6,77.6,62.4,76.2  L62.4,76.2z",fill:"#2E3436"},{path:"M68.4,36.8c0,0,3.4,1.4,3.6,2.7s0.2,1.5,0,1.5c-0.2,0-3.8-1.9-3.8-1.9v-2.3L68.4,36.8L68.4,36.8z",fill:"#D14C32"},{path:"M72,41.3l0-0.3L68.3,39v0.3L72,41.3z",fill:"#0D0E13"},{path:"M55.9,88.3H44.7c0,0-6.1-0.8-5.3,1.8c0.8,2.6-0.8,5.8,7.6,5.8h6.5c8.5,0,6.8-3.2,7.6-5.8  C62,87.4,55.9,88.3,55.9,88.3L55.9,88.3z",fill:"#D8684A"},{path:"M51,86.9c-5.2,0-9.8-1.1-13.1-3l-0.2,0c-0.3,2.4-0.3,2.2-0.2,2.3c0.1,0.1,2.9,1.8,7.9,2.6  c1.1,0.1,5.3,0.2,5.3,0.2v0c0,0,4.2-0.2,5.3-0.2c5-0.8,7.8-2.5,7.9-2.6c0,0-0.1-0.8-0.2-2C60.4,85.9,55.9,86.9,51,86.9z",fill:"#202226"},{path:"M58.3,51.8c1.2-3.8-0.8-5.2-3.1-5.6c-1.8-0.3-6.4-0.2-7.9-0.1c-2.7,0.2-5.6,1.3-4.2,5.7c2.4,7.5-0.1,17.8,0,19  c0.1,0.9,1.4,2.4,4,2.8c0.9,0.1,6.8,0.1,7.9-0.1c2.1-0.5,3.2-1.8,3.3-2.6C58.4,69.6,55.9,59.3,58.3,51.8L58.3,51.8z",fill:"#D8684A"}],$e=function(e){function t(){var e,a;Object(be.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(Ee.a)(this,(e=Object(Oe.a)(t)).call.apply(e,[this].concat(r)))).componentDidMount=function(){a.marker=[]},a.componentDidUpdate=function(e){var t=a.props,n=t.map,r=t.isCurrentPositionReceived,o=a.props.trip.currentLocation.speed,i=a.props.trip,c=i.angle,s=i.move;n===e.map&&r===e.isCurrentPositionReceived||a.renderMarker(),e.trip.path!==a.props.trip.path&&a.props.trip.path.length&&o>5&&(c!==e.angle||s>5)&&a.renderMarker()},a.componentWillUnmount=function(){a.removeMarker()},a.removeMarker=function(){a.marker&&a.marker.length>0&&a.marker.forEach(function(e){e.setMap(null)})},a.renderMarker=function(){a.removeMarker();var e=a.props,t=e.map,n=e.google,r=e.mapCenter,o=a.props.trip.currentLocation,i=o.lat?{lat:o.lat,lng:o.lng}:void 0,c=i||r;i=new n.maps.LatLng(c.lat,c.lng),Xe.forEach(function(e,r){var o={path:e.path,fillColor:e.fill,strokeColor:e.fill,fillOpacity:1,scale:.4,anchor:new n.maps.Point(50,50),rotation:a.props.trip.angle},c={map:t,position:i,icon:o};a.marker[r]=new n.maps.Marker(c),a.marker[r].setZIndex(100)})},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){return null}}]),t}(n.Component),Ye=Object(s.b)(function(e){return{trip:e.trip,mode:e.mode}})($e),et=function(e){function t(){var e,a;Object(be.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(Ee.a)(this,(e=Object(Oe.a)(t)).call.apply(e,[this].concat(r)))).handleSelection=function(e){a.props[e](),a.props.closeDrawerView()},a.markActiveTab=function(e){return window.location.hash.split("#/").pop()===e?" drawer-item-active":""},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"drawer"},r.a.createElement("div",{className:"drawer-logo"}),r.a.createElement("div",{className:"drawer-body"},[{id:"map",title:"Report a bump",action:"selectBumpsMapView"},{id:"checktrip",title:"Check your trip",action:"selectCheckTripView"},{id:"calibrate",title:"Calibrate sensors",action:"selectBumpsMapView"},{id:"settings",title:"Settings",action:"selectBumpsMapView"}].map(function(t){return r.a.createElement(c.b,{className:"drawer-item".concat(e.markActiveTab(t.id)),exact:"true",key:t.id,id:t.id,to:"/".concat(t.id),replace:!0,onClick:e.handleSelection(t.action)},t.title)})))}}]),t}(n.Component),tt=Object(s.b)(null,function(e){return{selectCheckTripView:I,selectBumpsMapView:x,closeDrawerView:z}})(et),at=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){a.loadMap()},a.componentDidUpdate=function(e,t){e.google===a.props.google&&e.selectedTrip===a.props.selectedTrip||a.loadMap()},a.loadMap=function(){if(a.props.google){var e=a.props.google.maps,t=a.props.selectedTrip,n=t.zoom,r=t.path,o=t.center,i=t.bumps,c={center:o,zoom:n,zoomControl:!1,scaleControl:!1,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1},s={path:r,strokeColor:"#4D8FAC",strokeOpacity:.8,strokeWeight:4},p={path:"M-4,0a4,4 0 1,0 8,0a4,4 0 1,0 -8,0",fillColor:"red",strokeColor:"red",fillOpacity:1,scale:.8,anchor:new e.Point(0,0)};a.map=new e.Map(a.mapRef.current,c),a.trip=new e.Polyline(s),a.map&&(a.trip.setMap(a.map),i.forEach(function(t,n){a.bumps.push(new e.Marker({position:{lat:t.lat,lng:t.lng},icon:p,map:a.map,animation:e.Animation.DROP}))}))}},a.componenWillUnmount=function(){a.trip.setMap(null),a.bumps.forEach(function(e){return e.setMap(null)})},a.mapRef=r.a.createRef(),a.trip=null,a.bumps=[],a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){if(this.props.selectedTrip){var e=this.props.dom,t=e.width,a=e.height;return r.a.createElement("div",{className:"favorities-map"},r.a.createElement("div",{ref:this.mapRef,style:{width:t+"px",height:a+"px",position:"relative"}}))}}}]),t}(n.Component),nt=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,dom:e.dom}})(at),rt=a(183),ot=a(185),it=a(187),ct=a(189),st=a(191),pt=a(184),lt=a(186),ut=a(188),dt=a(190),mt=a(192),ht=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){if(null===this.props.selectedTrip)return null;var e="https://alesiagit.github.io/reactjs_accel/#/shared/".concat(this.props.selectedTrip.id);return r.a.createElement("div",{className:"share-wrapper"},r.a.createElement("div",{className:"share-buttons-wrapper"},r.a.createElement(rt.a,{url:e,className:"share-social-icon"},r.a.createElement(pt.a,{size:38,round:!1,borderRadius:8})),r.a.createElement(ot.a,{url:e,className:"share-social-icon"},r.a.createElement(lt.a,{size:38,round:!1,borderRadius:8})),r.a.createElement(it.a,{url:e,className:"share-social-icon"},r.a.createElement(ut.a,{size:38,round:!1,borderRadius:8})),r.a.createElement(ct.a,{url:e,className:"share-social-icon"},r.a.createElement(dt.a,{size:38,round:!1,borderRadius:8})),r.a.createElement(st.a,{url:e,className:"share-social-icon"},r.a.createElement(mt.a,{size:38,round:!1,borderRadius:8}))))}}]),t}(n.Component),ft=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,menu:e.menu}})(ht),vt={closeDrawerView:z,selectDrawerView:A,selectBumpsMapView:x,selectFavoritiesListView:function(){return{type:T,menuitem:"isFavoritiesListView",title:"Report a bump",iconleft:"burger-icon",iconright:""}},selectShareView:function(){return{type:D,status:!0}},closeShareView:function(){return{type:N,status:!1}},startRecording:function(){return{type:_,mode:"isRecording",on:!0,color:"#e34929",text:"Stop Recording"}},stopRecording:function(){return{type:F}},noTripsSelected:function(){return{type:u,data:null}},changeBarColor:te},gt=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){a.props.changeBarColor("#4c88b7"),a.props.selectBumpsMapView(),a.props.stopRecording()},a.onLeftMenuToggle=function(){var e=a.props.menu,t=e.isDrawerView,n=e.isSelectedTripView;return t?a.props.closeDrawerView():n?(a.props.noTripsSelected(),void a.props.selectFavoritiesListView()):a.props.selectDrawerView()},a.onRightMenuToggle=function(){if(a.props.menu.isShareView)return a.props.closeShareView();a.props.selectShareView()},a.onNextStepButtonToggle=function(){if(a.props.mode.isRecording)return a.props.stopRecording();a.props.startRecording()},a.onSubmenuTabSelect=function(e){var t="select".concat(ze(e),"View");a.props[t]()},a.markActiveTab=function(e){var t="is".concat(ze(e),"View");return a.props.menu[t]},a.updateInterval=function(e,t){a.setState({interval:e,x:t})},a.state={interval:0,x:0},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this.props.menu.isDrawerView?"block":"none",t=this.props.menu.isShareView?"block":"none",a=this.props.mode,n=a.color,o=a.text;return r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"header"},r.a.createElement(Se,{onLeftMenuToggle:this.onLeftMenuToggle,onRightMenuToggle:this.onRightMenuToggle}),r.a.createElement(Ne,{onSubmenuTabSelect:this.onSubmenuTabSelect,markActiveTab:this.markActiveTab})),r.a.createElement(qe,{updateInterval:this.updateInterval}),r.a.createElement("div",{style:{position:"fixed",zIndex:1e3,top:"28vh",left:"20vh"}},this.state.interval,", ",this.state.x),r.a.createElement(Me,{color:n,text:o,toggleButton:this.onNextStepButtonToggle})),r.a.createElement("div",{className:"cover",style:{display:t}},r.a.createElement("div",{className:"cover-background",onClick:this.onRightMenuToggle}),r.a.createElement(ft,null)),r.a.createElement("div",{className:"cover",style:{display:e}},r.a.createElement("div",{className:"cover-background",onClick:this.onLeftMenuToggle}),r.a.createElement(tt,null)))}}]),t}(n.Component),bt=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,menu:e.menu,mode:e.mode}},vt)(gt),wt=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"slider"},r.a.createElement("div",{className:"slider-background"}),r.a.createElement("div",{className:"slider-foreground",style:{backgroundColor:this.props.color,width:"".concat(this.props.width,"%")}}),r.a.createElement("div",{className:"slider-dividers"},r.a.createElement("div",{className:"slider-divider"}),r.a.createElement("div",{className:"slider-divider"}),r.a.createElement("div",{className:"slider-divider"}),r.a.createElement("div",{className:"slider-divider"})))}}]),t}(n.Component),Et={selectTrip:m,selectTripView:V},Ot=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){a.getSharedTripData().then(function(){return a.getAppStatistics()}).then(function(){return a.setState({tripQuality:a.setTripQuality(),isDataReceived:!0})}).catch(function(e){return console.log(e)})},a.getSharedTripData=function(){var e=window.location.hash.split("#/shared/").pop();return ce.collection("shared").doc(e).get().then(function(e){if(e.exists)return e.data().tripdata}).then(function(e){a.props.selectTrip(e),a.props.selectTripView()})},a.getAppStatistics=function(){return ce.collection("stats").doc("totals").get().then(function(e){e.exists&&a.setState({stats:e.data()})})},a.toggleStats=function(){a.setState({isStatsView:!a.state.isStatsView})},a.setTripQuality=function(){var e=a.props.selectedTrip,t=a.state.stats,n=["low","moderate","good"],r=e.bumps.length/e.distance/(t.bumpsCount/t.distanceTotal)*100;return r<30?n[0]:r>70?n[2]:n[1]},a.state={isDataReceived:!1,isStatsView:!0,stats:null,tripQuality:"low"},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this.props.selectedTrip,t=this.state,a=t.isDataReceived,n=t.isStatsView,o=t.stats,i=t.tripQuality;if(!1===a)return null;var c=e.bumps.length,s=e.distance;return r.a.createElement("div",{className:"shared-wrapper"},r.a.createElement("div",{className:"shared-stats"},r.a.createElement("div",{className:"shared-summary-header"},r.a.createElement("div",{className:"shared-summary-wrapper"},r.a.createElement("div",{className:"shared-summary"},"Bumpy road informer"),r.a.createElement("div",{className:"shared-trip-quality"},"Trip quality: ",i," ")),r.a.createElement("div",{className:"collapse-icon",onClick:this.toggleStats})),r.a.createElement("div",{className:"shared-details-wrapper",style:{display:n?"flex":"none"}},r.a.createElement("div",{className:"shared-endpoints"},r.a.createElement("div",{className:"shared-address-line"},r.a.createElement("span",{className:"shared-address-destination"},"From: "),e.start),r.a.createElement("div",{className:"shared-address-line"},r.a.createElement("span",{className:"shared-address-destination"},"To: "),e.end)),r.a.createElement("div",{className:"shared-slider-wrapper"},r.a.createElement("div",{className:"slider-header"},r.a.createElement("span",{className:"slider-fieldname"},"Bumps per trip: "),c),r.a.createElement(wt,{color:"#7fb8e9",width:c/(o.bumpsCount/o.tripsCount)*100}),r.a.createElement("div",{className:"slider-header"},r.a.createElement("span",{className:"slider-fieldname"},"Bumps per km: "),(c/s).toFixed(2)),r.a.createElement(wt,{color:"#fbad19",width:c/s/(o.bumpsCount/o.distanceTotal)*100})))),r.a.createElement("div",{className:"shared-map"},r.a.createElement(qe,null)))}}]),t}(n.Component),yt=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,menu:e.menu}},Et)(Ot),Ct=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this,t=this.props.mode.isGuidance||this.props.mode.isBuildingRoute?"none":"flex";return r.a.createElement("div",{className:"search-menu",style:{display:t}},r.a.createElement("div",{className:"from-to-icon"}),r.a.createElement("div",{className:"search-form"},["start","end"].map(function(t){return r.a.createElement("div",{key:t,className:"search-input-wrapper"},r.a.createElement("input",{type:"text",name:t,value:e.props[t],className:"search-input",placeholder:"start"===t?"(Current position)":"",onFocus:e.props.preventResize,onChange:function(t){return e.props.handleChange(t)}}),r.a.createElement("div",{className:"search-cancel-btn",onClick:function(){return e.props.clearInput(t)}}))})))}}]),t}(n.Component),Tt=Object(s.b)(function(e){return{mode:e.mode}})(Ct),jt=function(e){function t(){return Object(be.a)(this,t),Object(Ee.a)(this,Object(Oe.a)(t).apply(this,arguments))}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"warning-wrapper",style:{display:this.props.display?"flex":"none"}},r.a.createElement("div",{className:"warning-inner"},r.a.createElement("div",{className:"warning-title"},"Bump ahead"),r.a.createElement("div",{className:"warning-sign"})))}}]),t}(n.Component),Mt={closeDrawerView:z,selectDrawerView:A,selectCheckTripView:I,startGuidance:function(){return{type:G,mode:"isGuidance",on:!0,color:"#e34929",text:"Stop Guidance"}},stopGuidance:function(){return{type:W,mode:"isGuidance",on:!1,color:"#fbad19",text:"Build a route"}},buildRoute:function(){return{type:P,mode:"isBuildingRoute",on:!0,text:"Start Guidance"}},changeBarColor:te},Lt=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){a.props.changeBarColor("#4c88b7"),a.props.selectCheckTripView(),a.props.stopGuidance()},a.preventResize=function(){console.log(a.props.dom);var e=a.props.dom,t=(e.width,e.height,e.ratio),n=window.innerWidth/t;document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, height=".concat(n,", user-scalable=no, initial-scale=1.0, maximum-scale=1.0"))},a.onLeftMenuToggle=function(){if(a.props.menu.isDrawerView)return a.props.closeDrawerView();a.props.selectDrawerView()},a.onNextStepButtonToggle=function(){var e=a.props.mode,t=e.isBuildingRoute,n=e.isGuidance;return t?a.props.startGuidance():n?a.props.stopGuidance():n||t?void 0:a.props.buildRoute()},a.onSearchButtonToggle=function(){a.props.stopGuidance()},a.handleInputChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(C.a)({},n,r))},a.clearInput=function(e){a.setState(Object(C.a)({},e,""))},a.reportBumpAhead=function(e){a.setState({isBumpAhead:e})},a.state={start:"",end:"",isBumpAhead:!1},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){var e=this.state,t=e.start,a=e.end,n=this.props.menu.isDrawerView?"block":"none",o=this.props.mode.isBuildingRoute?"flex":"none",i=this.props.mode,c=i.color,s=i.text;return r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"header"},r.a.createElement(Se,{onLeftMenuToggle:this.onLeftMenuToggle}),r.a.createElement(Tt,{handleChange:this.handleInputChange,clearInput:this.clearInput,start:t,end:a,preventResize:this.preventResize}),r.a.createElement("div",{className:"directions-btn",style:{display:o},onClick:this.onSearchButtonToggle})),r.a.createElement(qe,{start:t,end:a,reportBumpAhead:this.reportBumpAhead}),r.a.createElement(Me,{color:c,toggleButton:this.onNextStepButtonToggle,text:s})),r.a.createElement(jt,{display:this.state.isBumpAhead}),r.a.createElement("div",{className:"cover",style:{display:n}},r.a.createElement("div",{className:"cover-background",onClick:this.onLeftMenuToggle}),r.a.createElement(tt,null)))}}]),t}(n.Component),St=Object(s.b)(function(e){return{selectedTrip:e.selectedTrip,menu:e.menu,mode:e.mode,dom:e.dom}},Mt)(Lt),Dt=(a(181),{changeBarColor:te}),Nt=function(e){function t(){var e,a;Object(be.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(Ee.a)(this,(e=Object(Oe.a)(t)).call.apply(e,[this].concat(r)))).componentDidMount=function(){a.props.changeBarColor("#fbad19")},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"start-page-main"},r.a.createElement("div",{className:"logo-container"},r.a.createElement("div",{className:"logo-txt"},"Bumpy"),r.a.createElement("div",{className:"logo-txt"},"Roads"),r.a.createElement("div",{className:"logo-txt"},"Informer"))),r.a.createElement(c.b,{exact:"true",to:"/map",className:"bottom-ruler-btn"},"get started"))}}]),t}(n.Component),Bt=Object(s.b)(null,Dt)(Nt),kt={setDimentions:Y,setRatio:ee,addBumps:re,getStats:function(){return{type:se}}},Rt=Object(Te.a)(),Vt=function(e){function t(e){var a;return Object(be.a)(this,t),(a=Object(Ee.a)(this,Object(Oe.a)(t).call(this,e))).componentDidMount=function(){window.addEventListener("load",function(){return window.history.pushState({noBackExitsApp:!0},"")}),window.addEventListener("popstate",function(e){e.state&&e.state.noBackExitsApp&&window.history.pushState({noBackExitsApp:!0},"")}),a.updateStatusbarColor(),a.retrieveBumpsFromDatabase(),a.props.setDimentions({width:window.innerWidth,height:window.innerHeight}),a.props.setRatio(window.innerWidth/window.innerHeight)},a.componentDidUpdate=function(e){e.dom.color!==a.props.dom.color&&a.updateStatusbarColor()},a.updateStatusbarColor=function(){document.querySelector("meta[name=theme-color]").setAttribute("content",a.props.dom.color)},a.retrieveBumpsFromDatabase=function(){ce.collection("bumpsmap").doc("bumps").get().then(function(e){e.exists&&a.props.addBumps(e.data().bumps)}).then(function(){return a.setState({isFetching:!1})})},a.retrieveAppStatsFromDatabase=function(){},a.state={isFetching:!0},a}return Object(ye.a)(t,e),Object(we.a)(t,[{key:"render",value:function(){return this.state.isFetching?null:r.a.createElement(c.a,{history:Rt},r.a.createElement(Ce.a,{exact:!0,path:"/",component:Bt}),r.a.createElement(Ce.a,{exact:!0,path:"/map",component:bt}),r.a.createElement(Ce.a,{exact:!0,path:"/checktrip",component:St}),r.a.createElement(Ce.a,{path:"/shared/:number",component:yt}))}}]),t}(n.Component),At=Object(s.b)(function(e){return{dom:e.dom}},kt)(Vt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}),i.a.render(r.a.createElement(s.a,{store:ge},r.a.createElement(c.a,null,r.a.createElement(At,null))),document.getElementById("root"))},57:function(e,t,a){},58:function(e,t,a){},77:function(e,t,a){}},[[101,1,2]]]);
//# sourceMappingURL=main.d29c8722.chunk.js.map