(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(t,e,a){t.exports=a(52)},26:function(t,e,a){},27:function(t,e,a){},52:function(t,e,a){"use strict";a.r(e);var n=a(2),o=a.n(n),i=a(7),r=a.n(i);a(26),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,s=a(10),l=a(11),d=a(13),u=a(12),h=a(14),p=(a(27),a(20)),g=a(8),m=a(18),v=a.n(m).a.initializeApp({apiKey:"AIzaSyBexhCuV6JNCsyakFOeBK7NmFb_oM_pgxo",authDomain:"bumpyroadsinformer.firebaseapp.com",databaseURL:"https://bumpyroadsinformer.firebaseio.com",projectId:"bumpyroadsinformer",storageBucket:"",messagingSenderId:"854546127925",appId:"1:854546127925:web:d3c2a81c7c4e9ba6"}).firestore(),f=a(15),b={lat:53.7378391,lng:27.203723,speed:0,timestamp:new Date(Date.now()).getTime()},w={x:0,y:0,z:0},y=0,k=6371e3,E="53.977897,27.393723",O=function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).componentDidMount=function(){var t,e=a.canvas.current;a.setState({context:e.getContext("2d")}),v.collection("coverage").get().then(function(e){e.forEach(function(e){t=e.data().data?JSON.parse(e.data().data):[]})}).then(function(){a.setState({context:e.getContext("2d"),isReceived:!0,data:t},function(){return console.log(a.state.data)})})},a.startRecording=function(){if(console.log(a.state.data),"geolocation"in navigator){c=navigator.geolocation.watchPosition(a.updatePositionData,a.err,{enableHighAccuracy:!0,timeout:1e3,maximumAge:0}),window.DeviceMotionEvent&&window.addEventListener("devicemotion",a.updateAccelerationData)}},a.err=function(){console.log("error")},a.updateAccelerationData=function(t){var e=t.acceleration.x,n=t.acceleration.y,o=t.acceleration.z;null!==e&&null!==n&&null!==o&&a.setState({currentAcceleration:{x:e,y:n,z:o}},function(){y===a.canvas.current.width&&(y=0),a.drawBackground("white",0);var t=1,e=a.state.currentAcceleration;for(var n in e)a.drawLine(e[n],t),t++;y++,a.drawBackground("grey",1);for(var o=2;o<8;o++)a.drawBackground("white",o)})},a.toRad=function(t){return t*Math.PI/180},a.calculateDistance=function(t,e,n,o){var i=a.toRad(n-t),r=a.toRad(o-e),c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(a.toRad(t))*Math.cos(a.toRad(n))*Math.sin(r/2)*Math.sin(r/2);return 2*k*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))},a.drawLine=function(t,e){var n=a.state.context,o=100*e-50;n.beginPath(),n.strokeStyle="black",n.moveTo(y,o+5*t),n.lineTo(y,o),n.stroke()},a.drawBackground=function(t,e){var n=a.state.context;n.beginPath(),n.strokeStyle=t,n.moveTo(y+e,0),n.lineTo(y+e,300),n.stroke()},a.updatePositionData=function(t){a.setState({prevPosition:Object(g.a)({},a.state.currentPosition)},function(){var e=a.state.prevPosition,n=t.coords.latitude,o=t.coords.longitude,i=t.timestamp,r=a.calculateDistance(e.lat,e.lng,n,o),c=(e.timestamp-i)/1e3,s=Math.abs(r/c);a.setState({currentPosition:{lat:n,lng:o,speed:s,timestamp:i},data:[].concat(Object(p.a)(a.state.data),[{lat:n,lng:o}])},function(){console.log(a.state.data)})})},a.updateResultingData=function(){},a.stopRecording=function(){console.log("stopped"),console.log(a.state.data),v.collection("coverage").doc(E).set({data:JSON.stringify(a.state.data)}),navigator.geolocation.clearWatch(c),window.removeEventListener("devicemotion",a.updateAccelerationData)},a.showChart=function(){a.setState({isChart:!a.state.isChart})},a.state={isReceived:!1,isChart:!1,data:[],currentPosition:Object(g.a)({},b),prevPosition:Object(g.a)({},b),currentAcceleration:Object(g.a)({},w),context:null,zoom:11},a.canvas=o.a.createRef(),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("button",{onClick:this.startRecording,disabled:!this.state.isReceived},"Start recording"),o.a.createElement("button",{onClick:this.showChart},"Show chart"),o.a.createElement("div",null,"lat=",this.state.currentPosition.lat),o.a.createElement("div",null,"lng=",this.state.currentPosition.lng),o.a.createElement("div",null,"speed=",this.state.currentPosition.speed),o.a.createElement("canvas",{id:"canvas",width:"400",height:"300",ref:this.canvas,style:{display:this.state.isChart?"block":"none"}}),o.a.createElement("div",{id:"map",style:{width:"400px",height:"300px",position:"relative"}},o.a.createElement(f.Map,{google:this.props.google,style:{width:"100%",height:"100%",position:"relative"},zoom:11,initialCenter:this.state.currentPosition},o.a.createElement(f.Polyline,{path:this.state.data,strokeColor:"#0000FF",strokeOpacity:.8,strokeWeight:2}))),o.a.createElement("button",{onClick:this.stopRecording},"Stop recording"))}}]),e}(n.Component),P=Object(f.GoogleApiWrapper)({apiKey:"AIzaSyAxb5QU5mete251oQLxJgElz6Pgv_P9LGQ"})(O),x=function(t){function e(){return Object(s.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(P,null))}}]),e}(n.Component);r.a.render(o.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.9288a86e.chunk.js.map